<?xml version="1.0" encoding="utf-8"?>

<feed xmlns="http://www.w3.org/2005/Atom" >
  <generator uri="https://jekyllrb.com/" version="4.1.1">Jekyll</generator>
  <link href="https://old.tacosdedatos.com/tag/kaggle/feed.xml" rel="self" type="application/atom+xml" />
  <link href="https://old.tacosdedatos.com/" rel="alternate" type="text/html" />
  <updated>2021-08-01T20:46:16+00:00</updated>
  <id>https://old.tacosdedatos.com/tag/kaggle/feed.xml</id>

  
  
  

  
    <title type="html">üåÆ tacos de datos | Aprende visualizaci√≥n de datos en espa√±ol. | </title>
  

  
    <subtitle>Tu sitio para aprender de visualizaci√≥n y ciencia de datos en espa√±ol. Consejos, recursos y mejores pr√°cticas para tus proyectos de tecnolog√≠a, periodismo de datos y an√°lisis estad√≠sticos.</subtitle>
  

  

  
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  

  
  

  
    <entry>
      <title type="html">Generando datasets de Kaggle autom√°ticamente</title>
      <link href="https://old.tacosdedatos.com/generacion-automatica-datasets" rel="alternate" type="text/html" title="Generando datasets de Kaggle autom√°ticamente" />
      <published>2020-03-11T10:00:00+00:00</published>
      <updated>2020-03-11T10:00:00+00:00</updated>
      <id>https://old.tacosdedatos.com/generacion-automatica-datasets</id>
      <content type="html" xml:base="https://old.tacosdedatos.com/generacion-automatica-datasets">&lt;p&gt;S√© que Tacos de Datos est√° enfocado principalmente al resultado visual, pero creo que es importante tratar de resaltar qu√© es lo que hay detr√°s de. Quisiera inaugurar esta secci√≥n que llamar√© &lt;em&gt;‚ÄúDetr√°s de la visualizaci√≥n‚Äù&lt;/em&gt; para cubrir temas de extracci√≥n, procesamiento y almacenamiento de datos; en pocas palabras: ingenier√≠a de datos. &lt;em&gt;Y es que, adem√°s de preparar los tacos, tambi√©n es bueno saber c√≥mo conseguir los ingredientes.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;PD: Mira cu√°l es el resultado de lo que estoy explicando aqu√≠: &lt;a href=&quot;https://www.kaggle.com/ioexception/medium-daily-digests&quot;&gt;Medium Daily Digests on Kaggle&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;fuente-de-los-datos-y-su-recolecci√≥n&quot;&gt;Fuente de los datos y su recolecci√≥n&lt;/h2&gt;

&lt;p&gt;Ya ten√≠a tiempo queriendo hacer un dataset con informaci√≥n extra√≠da de Medium.com. Al principio, pens√© en hacer &lt;em&gt;web scraping&lt;/em&gt; masivamente en las publicaciones de Medium; el problema es que no proporcionan un sitio web ni f√°cil de &lt;em&gt;crawlear&lt;/em&gt; ni f√°cil de extraer informaci√≥n‚Ä¶ luego pens√© en ese ‚ÄúMedium Daily Digest‚Äù, un &lt;em&gt;newsletter&lt;/em&gt; que recibo todos los d√≠as, en √©l, Medium me env√≠a historias que ‚Äúme pueden interesar‚Äù; Recuerdo que cuando me suscrib√≠, tuve que elegir mis temas preferidos, y desde entonces siempre recibo un correo con art√≠culos sobre ellos.&lt;/p&gt;

&lt;p&gt;Con eso en mente, me propuse crear 20 cuentas de correo electr√≥nico diferentes (en realidad son alias para una sola cuenta) y luego usar cada una de ellas para suscribirse al mentado ‚ÄúMedium Daily Digest‚Äù, cada cuenta asociada con cinco diferentes (pero un tanto relacionados) temas. Y desde entonces he estado recibiendo 20 correos electr√≥nicos, todos los d√≠as con t√≠tulos, subt√≠tulos y URLs de posts.&lt;/p&gt;

&lt;p&gt;De vez en cuando inicio sesi√≥n en esas cuentas, abro algunos correos electr√≥nicos para evitar que dichas cuentas se eliminen de la sindicaci√≥n de Medium &lt;a href=&quot;(https://www.theverge.com/2019/7/3/20681508/tracking-pixel-email-spying-superhuman-web-beacon-open-tracking-read-receipts-location)&quot;&gt;porque esta gente sabe cu√°ndo no lees sus correos electr√≥nicos&lt;/a&gt;. Tambi√©n es de esperarse que los temas que ofrecen puedan cambiar con el tiempo, y en alg√∫n momento los intereses asociados de algunas cuentas pueden cambiar, en ese caso tendr√© que iniciar sesi√≥n en Medium y modificar las cuentas  manualmente, pero en su mayor parte la recopilaci√≥n de datos se ejecuta de manera autom√°tica.&lt;/p&gt;

&lt;p&gt;Por cierto, no estoy seguro de si el conjunto de datos ser√° √∫til para alguien, pero espero que la forma en que lo constru√≠ con Python sea √∫til para cualquiera con datos m√°s importantes.&lt;/p&gt;

&lt;h2 id=&quot;leyendo-los-correos-del-servidor&quot;&gt;Leyendo los correos del servidor&lt;/h2&gt;

&lt;p&gt;Como lo mencion√© anteriormente, los correos electr√≥nicos llegan a mi cuenta, y no es divertido tener que descargar 20 correos electr√≥nicos manualmente todos los d√≠as, por lo tanto, por primera vez en este art√≠culo: Python al rescate.&lt;/p&gt;

&lt;p&gt;Para acceder a los correos electr√≥nicos en mi servidor, uso el protocolo IMAP; Esto me permite leerlos sin tenerlos que borrar del servidor, en caso de que quiera acceder a ellos en el futuro. Para esto, a pesar de que Python ofrece el m√≥dulo &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;imaplib&lt;/code&gt; para interactuar con dichos servidores, decid√≠ usar el paquete &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;imapclient&lt;/code&gt; que, en mi opini√≥n, hace que el c√≥digo sea un poco m√°s limpio y comprensible. Leer todos los correos electr√≥nicos de una cuenta es tan f√°cil como muestra este fragmento de c√≥digo:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;email&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;imapclient&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IMAPClient&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IMAPClient&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;host&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imap_server&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;use_uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;  
    &lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;login&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;account&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;password&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  
    &lt;span class=&quot;n&quot;&gt;messages&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;search&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;NOT&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;DELETED&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;  
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;message_id&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;messages&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;  
        &lt;span class=&quot;n&quot;&gt;fetched&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fetch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;message_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;RFC822&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  
        &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fetched&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;message_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;  
        &lt;span class=&quot;n&quot;&gt;email_message&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;email&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;message_from_bytes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;RFC822&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;yield&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;message_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;email_message&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Como puede ver, usamos &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;IMAPClient&lt;/code&gt; como &lt;em&gt;context manager&lt;/em&gt;, luego iniciamos sesi√≥n con nuestras credenciales de correo electr√≥nico (s√≠, es una pena que tengamos que usar nuestra contrase√±a directamente); despu√©s de iniciar sesi√≥n, buscamos todos los correos electr√≥nicos que no hemos eliminado (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;NOT&lt;/code&gt; &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DELETED&lt;/code&gt;), esto devolver√° una lista de cadenas que contienen los identificadores para cada mensaje; podemos iterar sobre estos identificadores y usar el cliente ejecut√°ndo &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fetch&lt;/code&gt; para obtener cada mensaje, especificando que queremos la propiedad &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;RFC822&lt;/code&gt; del correo electr√≥nico.&lt;/p&gt;

&lt;p&gt;El valor de retorno de &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;fetch&lt;/code&gt; ser√° un diccionario de la forma &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;{ message_id: { b&quot;RFC822&quot;: (bytes) } }&lt;/code&gt;, podemos transformar f√°cilmente estos bytes en una representaci√≥n de correo electr√≥nico m√°s pyt√≥nica mediante el uso de la funci√≥n &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;message_from_bytes&lt;/code&gt;. Puedes ver mi implementaci√≥n real en la funci√≥n &lt;a href=&quot;https://github.com/fferegrino/medium-collector/blob/v0.0.0/medium_collector/download/reader.py#L6&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;read_from_mail&lt;/code&gt;&lt;/a&gt; en mi repositorio.&lt;/p&gt;

&lt;h2 id=&quot;extrayendo-datos-del-correo-electr√≥nico&quot;&gt;Extrayendo datos del correo electr√≥nico&lt;/h2&gt;

&lt;p&gt;Teniendo un correo electr√≥nico con el que sea f√°cil trabajar en Python, me referir√© una publicaci√≥n anterior sobre &lt;a href=&quot;https://dev.to/fferegrino/reading-emails-with-python-4o72&quot;&gt;c√≥mo leer trabajar con correos electr√≥nicos con Python&lt;/a&gt;. Una vez que podemos &lt;em&gt;‚Äúleer‚Äù&lt;/em&gt; el mensaje, podemos acceder a propiedades como &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;To&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;From&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Subject&lt;/code&gt; y &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Date&lt;/code&gt;, as√≠ como acceder al contenido real del correo electr√≥nico. Para referencia, mira este fragmento de c√≥digo donde &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;message&lt;/code&gt; es lo que obtenemos al llamar a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;message_from_bytes&lt;/code&gt; en el fragmento de c√≥digo anterior:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;datetime&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;quopri&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;parts&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;part&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_content_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;part&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;part&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()}&lt;/span&gt;  
&lt;span class=&quot;n&quot;&gt;html&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;quopri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decodestring&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;text/html&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;].&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()).&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;utf8&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;   
&lt;span class=&quot;n&quot;&gt;mail_info&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;  
    &lt;span class=&quot;s&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Message-ID&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;  
    &lt;span class=&quot;s&quot;&gt;&quot;to&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;To&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;  
    &lt;span class=&quot;s&quot;&gt;&quot;from&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;From&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;  
    &lt;span class=&quot;s&quot;&gt;&quot;date&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;datetime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;datetime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strptime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;  
        &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Date&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;%a, %d %b %Y %H:%M:%S +0000 (%Z)&quot;&lt;/span&gt;  
    &lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;  
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;El resultado final de este fragmento es producir un diccionario (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mail_info&lt;/code&gt;) que contenga informaci√≥n b√°sica del correo electr√≥nico y la versi√≥n html del correo electr√≥nico (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;html&lt;/code&gt;). Puedes ver mi implementaci√≥n real en la funci√≥n &lt;a href=&quot;https://github.com/fferegrino/medium-collector/blob/v0.0.0/medium_collector/download/parser.py#L34&quot;&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;parse_mail&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Para trabajar con el HTML del correo electr√≥nico utilic√© BeautifulSoup, no entrar√© en detalles, pero como siempre en &lt;em&gt;web scraping&lt;/em&gt;, fue un proceso de prueba y error obtener la estructura adecuada para extraer informaci√≥n del contenido del correo. Puedes ver la funci√≥n de extracci√≥n completa &lt;a href=&quot;https://github.com/fferegrino/medium-collector/blob/master/medium_collector/download/parser.py#L50&quot;&gt;aqu√≠&lt;/a&gt;, todo se reduce a una lista de diccionarios (uno para cada publicaci√≥n en el correo electr√≥nico) con la siguiente informaci√≥n: &lt;em&gt;section_title&lt;/em&gt;, &lt;em&gt;post_title&lt;/em&gt;, &lt;em&gt;post_subtitle&lt;/em&gt;, &lt;em&gt;post_url&lt;/em&gt;, &lt;em&gt;author_name&lt;/em&gt;, &lt;em&gt;author_handle&lt;/em&gt;, &lt;em&gt;site_name&lt;/em&gt;, &lt;em&gt;site_slug&lt;/em&gt;, &lt;em&gt;members_only&lt;/em&gt;:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/jmkVSgz.png&quot; alt=&quot;Extraction description&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;small&gt;(en restrospectiva, pude haber extra√≠do el tiempo de lectura‚Ä¶ tal vez para la siguiente versi√≥n)&lt;/small&gt;.&lt;/p&gt;

&lt;h2 id=&quot;guardando-la-informaci√≥n&quot;&gt;Guardando la informaci√≥n&lt;/h2&gt;

&lt;p&gt;Despu√©s de descargar la informaci√≥n, esta es almacenada en dos archivos csv:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;em&gt;mails.csv&lt;/em&gt;, que es un archivo de todos los correos electr√≥nicos recibidos, este contiene:
    &lt;ul&gt;
      &lt;li&gt;&lt;strong&gt;id&lt;/strong&gt;: un identificador √∫nico del correo electr√≥nico&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;date&lt;/strong&gt;: la fecha y hora en que se recibi√≥ el correo electr√≥nico&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;to&lt;/strong&gt;: un hash de la cuenta de correo electr√≥nico a la que se envi√≥ este correo electr√≥nico&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;from&lt;/strong&gt;: la cuenta de correo electr√≥nico utilizada para enviar el correo electr√≥nico (siempre es la misma)&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;subject&lt;/strong&gt;:  el asunto del correo electr√≥nico&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;em&gt;articles_mails.csv&lt;/em&gt;, contiene la informaci√≥n extra√≠da de cada correo electr√≥nico, asociada al correo electr√≥nico del que provienen:
    &lt;ul&gt;
      &lt;li&gt;&lt;strong&gt;mail_id&lt;/strong&gt;: un identificador √∫nico del correo electr√≥nico del que proviene este art√≠culo, corresponde a &lt;strong&gt;id&lt;/strong&gt; en el archivo &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mails.csv&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;post_url&lt;/strong&gt;: la url del art√≠culo&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;post_title&lt;/strong&gt;: el t√≠tulo del art√≠culo&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;post_subtitle&lt;/strong&gt;: el subt√≠tulo del art√≠culo&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;section_title&lt;/strong&gt;: el t√≠tulo de la secci√≥n en la que encontr√≥ la publicaci√≥n&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;members_only&lt;/strong&gt;: una bandera que especifica si el art√≠culo es para miembros de Medium&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;author_name&lt;/strong&gt;: nombre del autor del art√≠culo&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;author_handle&lt;/strong&gt;: identificador del autor del art√≠culo&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;site_name&lt;/strong&gt;: si el art√≠culo se public√≥ en un sitio, este contiene el nombre de dicho sitio&lt;/li&gt;
      &lt;li&gt;&lt;strong&gt;site_slug&lt;/strong&gt;: si el art√≠culo se public√≥ en un sitio, este contiene el identificador de dicho sitio&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Para escribir toda esta informaci√≥n en los archivos, utilic√© el m√≥dulo &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;csv&lt;/code&gt; siempre confiable, en particular, la clase &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DictWriter&lt;/code&gt; que permite el uso de diccionarios cuando se llama al m√©todo &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;writerow&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;csv&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;EMAILS_FILE_HEADERS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;date&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;to&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;from&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;subject&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;emails&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[{&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;date&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;datetime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; 
           &lt;span class=&quot;s&quot;&gt;&quot;to&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;cosme@fulanito.com&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;from&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;noreply@medium.com&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
	   &lt;span class=&quot;s&quot;&gt;&quot;subject&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Don't miss this!&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}]&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;mails.csv&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;w&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;writable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;writer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DictWriter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;writable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fieldnames&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;EMAILS_FILE_HEADERS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;writer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;writeheader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
	&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;email&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;emails&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
		&lt;span class=&quot;n&quot;&gt;writer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;writerow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;email&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;En realidad, lo que hago es un poco m√°s complicado, ya que quiero agregar filas al conjunto de datos de forma incremental; por lo tanto, el archivo debe abrirse con &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&quot;a&quot;&lt;/code&gt; como modo de archivo, no con &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&quot;w&quot;&lt;/code&gt; y es necesario tener especial cuidado para no escribir los encabezados en el medio del archivo tampoco. Puedes verificar toda la implementaci√≥n de las funciones de escritura en &lt;a href=&quot;https://github.com/fferegrino/medium-collector/blob/v0.0.0/medium_collector/download/writer.py&quot;&gt;este fragmento de c√≥digo&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&quot;cargando-la-informaci√≥n-a-s3&quot;&gt;Cargando la informaci√≥n a S3&lt;/h2&gt;

&lt;p&gt;Pero, ¬øde qu√© sirven estos datos si van a vivir guardados en mi computadora? Para superar este problema, pens√© en cargar los datos en un &lt;em&gt;bucket&lt;/em&gt; de S3, para que est√©n disponibles para descargarlo en cualquier lugar que lo necesite. Para acceder a cualquier recurso de AWS, mi herramienta favorita es el paquete &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;boto3&lt;/code&gt; que es una verdadera navaja suiza para AWS.&lt;/p&gt;

&lt;p&gt;Supongamos que desea cargar el archivo &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;medium_data/mails.csv&lt;/code&gt; en el bucket &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&quot;medium_bucket&quot;&lt;/code&gt; y que se llame &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&quot;mails.csv&quot;&lt;/code&gt;, el siguiente c√≥digo ser√° suficiente:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;boto3&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;bucket&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;my_super_cool_bucket&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;client&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;boto3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;  
	&lt;span class=&quot;s&quot;&gt;&quot;s3&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;aws_access_key_id&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ACCESS_KEY&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;aws_secret_access_key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;SECRET_KEY&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;  
	&lt;span class=&quot;n&quot;&gt;region_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;eu-west-2&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;upload_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;medium_data/mails.csv&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bucket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;mails.csv&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Pero no quiero seguir cargando el mismo archivo una y otra vez si no hay necesidad de hacerlo. Para lograr esto, es posible verificar si el archivo existe en nuestro &lt;em&gt;bucket&lt;/em&gt; y resumir su contenido con un hash &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;md5&lt;/code&gt; generado por el propio AWS. Entonces es solo una cuesti√≥n de comparar dicho hash con el hash del archivo local y si son iguales, no subo el archivo:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;hashlib&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_file_hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;file_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;   
	&lt;span class=&quot;n&quot;&gt;hash_md5&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hashlib&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;md5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;  
	&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;file_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;rb&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;readable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;  
		&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chunk&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;iter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;readable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4096&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;sa&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;  
			&lt;span class=&quot;n&quot;&gt;hash_md5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chunk&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  
	&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hash_md5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hexdigest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head_object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Bucket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bucket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;mails.csv&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;md5_signature&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;get_file_hash&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;medium_data/mails.csv&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;ETag&quot;&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;head&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;literal_eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ETag&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;md5_signature&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
	&lt;span class=&quot;c1&quot;&gt;# The file already exists, do nothing
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;upload_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;medium_data/mails.csv&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bucket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;mails.csv&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;El m√©todo al que se debe llamar para obtener informaci√≥n para un objeto es &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;head_object&lt;/code&gt;. Por cierto, toda la l√≥gica y la implementaci√≥n est√°n en &lt;a href=&quot;https://github.com/fferegrino/medium-collector/blob/v0.0.0/medium_collector/s3.py&quot;&gt;este archivo&lt;/a&gt; si quieres verlo.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Algunas consideraciones&lt;/em&gt;: para este ejemplo, consider√© que el &lt;em&gt;dep√≥sito&lt;/em&gt; ya existe, sin embargo, si no existe, tambi√©n es posible usar &lt;em&gt;boto&lt;/em&gt; para crearlo. Como dije, &lt;em&gt;boto&lt;/em&gt; es un monstruo de biblioteca que debes considerar si trabajas con AWS. Tambi√©n estoy usando las credenciales directamente en la llamada a la creaci√≥n del cliente para &lt;em&gt;s3&lt;/em&gt;, pero hay varias formas de manejar la autenticaci√≥n con &lt;em&gt;boto&lt;/em&gt;, consulta la documentaci√≥n para obtener m√°s informaci√≥n.&lt;/p&gt;

&lt;h2 id=&quot;cargando-los-datos-a-kaggle&quot;&gt;Cargando los datos a Kaggle&lt;/h2&gt;

&lt;p&gt;Hasta ahora, todo va muy bien, pero el conjunto de datos todav√≠a est√° disponible para m√≠, y aunque podr√≠a hacer p√∫blico mi &lt;em&gt;bucket&lt;/em&gt; de s3, hay algunos problemas con esto:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;No quiero que mi factura de S3 suba por el cielo si alguien con intenciones maliciosas se apodera de mi s3&lt;/li&gt;
  &lt;li&gt;Quiero que la gente use los datos, y con una url de s3 no es muy f√°cil de descubrir o promocionar el &lt;em&gt;dataset&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Pero hay un buen lugar para almacenar conjuntos de datos, es gratuito y, al mismo tiempo, indexa los datos y los hace visibles al p√∫blico en generar. Estoy hablando de Kaggle.&lt;/p&gt;

&lt;p&gt;Kaggle hace que sea relativamente f√°cil interactuar con algunos de los recursos que ofrece el sitio web a trav√©s de su paquete &lt;a href=&quot;https://github.com/Kaggle/kaggle-api&quot;&gt;kaggle-api&lt;/a&gt;. En general, promueven la interacci√≥n a trav√©s de la l√≠nea de comando, sin embargo, tambi√©n es posible utilizar la API program√°tica que alimenta el &lt;em&gt;cli&lt;/em&gt;. Para cargar una nueva versi√≥n de mi conjunto de datos tuve que hacer algo como esto:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;kaggle&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;api&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;upload_to_kaggle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data_folder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
	&lt;span class=&quot;n&quot;&gt;api&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dataset_create_version&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data_folder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;quiet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
	
&lt;span class=&quot;n&quot;&gt;upload_to_kaggle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;medium_data&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;A new version of this dataset&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Y eso es todo. Realmente, es as√≠ de f√°cil. Pero no tan r√°pido, es decir, si queremos actualizar un conjunto de datos, si estamos creando uno desde cero, primero debemos realizar tres cosas:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Crear una carpeta (por ejemplo, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&quot;medium_data&quot;&lt;/code&gt;) donde solo existen los archivos correspondientes a nuestro conjunto de datos&lt;/li&gt;
  &lt;li&gt;Tener un archivo llamado &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dataset-metadata.json&lt;/code&gt; en esa carpeta con los metadatos para su conjunto de datos, el aspecto del archivo debe parecerse al siguiente (pero puedes revisar el de mi app &lt;a href=&quot;https://github.com/fferegrino/medium-collector/blob/v0.0.0/data/dataset-metadata.json&quot;&gt;para un ejemplo m√°s concreto&lt;/a&gt;):&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;{
  &quot;title&quot;: &quot;My Awesome Dataset&quot;, 
  &quot;id&quot;: &quot;cosme_fulanito/my-awesome-dataset&quot;, 
  &quot;licenses&quot;: [{&quot;name&quot;: &quot;CC0-1.0&quot;}]
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;ul&gt;
  &lt;li&gt;Ejecutar &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;kaggle datasets create -p medium_data&lt;/code&gt; en la consola, o usar el m√©todo &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dataset_create_new&lt;/code&gt; program√°ticamente.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Realic√© esas tareas manualmente, ya que no es como si anduviera creando &lt;em&gt;datasets&lt;/em&gt; a cada rato, sino que simplemente los estoy tratando de actualizar, tu caso de uso puede ser diferente.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Algunas consideraciones&lt;/em&gt;: al igual que AWS, Kaggle tambi√©n ofrece algunas formas de autenticaci√≥n con su servicio, utilic√© el que m√°s promocionan: un archivo kaggle.json en &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;~/.kaggle&lt;/code&gt;, pero puede usar algo diferente.&lt;/p&gt;

&lt;h2 id=&quot;pruebas&quot;&gt;Pruebas&lt;/h2&gt;

&lt;p&gt;Al igual que con cualquier pieza de software que se pondr√° en producci√≥n y que se ejecutar√° sin supervisi√≥n (sin mencionar que mi factura de s3 depende de que esto funcione correctamente), es bueno tener algunas pruebas solo para asegurarse de que haga lo que programamos. Sin embargo, inicialmente ten√≠a la intenci√≥n de escribir sobre las pruebas en esta publicaci√≥n, pero este post ya es suficientemente largo, por lo que publicar√© c√≥mo prob√© la aplicaci√≥n en una publicaci√≥n futura, as√≠ que aseg√∫rate de seguirme si quieres aprender sobre pruebas, &lt;em&gt;patching&lt;/em&gt; y &lt;em&gt;mocks&lt;/em&gt; (incluy√©ndo pruebas con servicios de AWS).&lt;/p&gt;

&lt;h3 id=&quot;preguntas-comentarios&quot;&gt;¬øPreguntas? ¬øcomentarios?&lt;/h3&gt;

&lt;p&gt;No olvides que me puedes dejar un comentario aqu√≠ o enviarme un tuit en &lt;a href=&quot;https://twitter.com/io_exception&quot;&gt;@io_exception&lt;/a&gt;, con gusto te ayudo si las cosas no est√°n claras o necesitas m√°s explicaci√≥n sobre el c√≥digo. Recuerda que la aplicaci√≥n completa est√° &lt;a href=&quot;https://github.com/fferegrino/medium-collector/tree/v0.0.0&quot;&gt;disponible en GitHub&lt;/a&gt; para que puedas jugar con el c√≥digo.&lt;/p&gt;</content>

      
      
      
      
      

      <author>
          <name>Antonio Feregrino Bola√±os</name>
        
        
      </author>

      

      
        <category term="blog" />
      
        <category term="python" />
      
        <category term="kaggle" />
      

      
        <summary type="html">S√© que Tacos de Datos est√° enfocado principalmente al resultado visual, pero creo que es importante tratar de resaltar qu√© es lo que hay detr√°s de. Quisiera inaugurar esta secci√≥n que llamar√© ‚ÄúDetr√°s de la visualizaci√≥n‚Äù para cubrir temas de extracci√≥n, procesamiento y almacenamiento de datos; en pocas palabras: ingenier√≠a de datos. Y es que, adem√°s de preparar los tacos, tambi√©n es bueno saber c√≥mo conseguir los ingredientes.</summary>
      

      
      
    </entry>
  
</feed>
